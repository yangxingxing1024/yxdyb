<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
    <script src="../static/vue.js"></script>
    <link href="..\static\bootstrap.css" rel="stylesheet"/>
    <script src="https://cdn.staticfile.org/vue-resource/1.5.1/vue-resource.min.js"></script>
</head>
<body>
<div id="app">

    <div class="panel panel-primary">
        <div class="panel-heading">
            <h3 class="panel-title">添加品牌</h3>
        </div>
        <div class="panel-body form-inline">
            <label for="">Id:
                <input type="text"  class="form-control" v-model="id">
            </label>
            <label for="">Name:
                <input type="text" class="form-control" v-model="name">
            </label>
            <!-- 在vue中使用事件绑定机制,如果加了小括号就可以给函数传参了 -->
            <input type="button" value="添加" class="btn btn-primary" @click="add">
            <label for="">搜索名称关键字:
                <input type="text" class="form-control" v-model="keywords">
            </label>

        </div>
    </div>

    <table class="table table-hover table-striped">
        <thead>
        <tr>
            <th>Id</th>
            <th>Name</th>
            <th>Password</th>
            <th>Operation</th>
        </tr>
        </thead>
        <tbody>
        <tr v-for="item in list" :key="item.id">
            <td>{{ item.id }}</td>
            <td>{{ item.username }}</td>
            <td>{{ item.password }}</td>
            <td><a href="" @click.prevent="del(item.id)"> 删除</a></td>
        </tr>
        </tbody>
    </table>

</div>

<script>
    Vue.http.options.root = 'http://localhost:8080/';
    Vue.http.options.emulateJSON = true;

    // 过滤器的定义语法 全局的过滤器(就是所有的vm实例都共享的),进行时间的格式化
    //g过滤器的第一个参数已经被规定死了,永远是过滤器管道传递过来的数据
    Vue.filter('dateFormat',function(dateStr){
        var dt=new Date(dateStr)
        var year=dt.getFullYear()
        var m=dt.getMonth() + 1
        var d=dt.getDate()
        return `${year}-${m}-${d}`
    })

    var vm = new Vue({
        el: '#app',
        data: {
            list:'' ,
            id:'',
            name:'',
            keywords:''
        },
        created:function(){
          this.getAllList();
        },
        methods: {
            add(){
                this.$http.post('addUser',{username:this.name}, {emulateJSON:true}).then(result => {
                    var result = result.body
                    this.getAllList();
                    this.name = '';
                })
            },
            getAllList(){
                this.$http.get('findUsers').then(result => {
                    var result = result.body;
                    this.list = result;
                });
            },
            del(id){
                this.$http.get('deleteUserById/'+id).then(result => {
                    this.getAllList()

                })
            }
        }
    });

    </script>
</body>
</html>